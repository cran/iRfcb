<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Quality Control of IFCB Data</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Quality Control of IFCB Data</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This vignette provides an overview of quality control (QC) methods
for Imaging FlowCytobot (IFCB) data using the <code>iRfcb</code>
package. The package offers tools to analyze Particle Size Distribution
(PSD) following Hayashi et al. (2025), verify geographical positions,
and integrate contextual data from sources like ferrybox systems. These
QC workflows ensure high-quality datasets for phytoplankton and
microzooplankton monitoring in marine ecosystems.</p>
<p>You’ll learn how to:</p>
<ul>
<li>Set up the <code>iRfcb</code> package and <code>Python</code>
environment.</li>
<li>Analyze particle size distributions for data quality.</li>
<li>Check spatial metadata for proximity to land, basin classification,
and missing positions.</li>
</ul>
<p>Follow this tutorial to streamline the QC process and ensure reliable
IFCB data.</p>
</div>
<div id="getting-started" class="section level2">
<h2>Getting Started</h2>
<div id="installation" class="section level3">
<h3>Installation</h3>
<p>You can install the package from CRAN using:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;iRfcb&quot;</span>)</span></code></pre></div>
<p>Some functions from the <code>iRfcb</code> package used in this
tutorial require <code>Python</code> to be installed. You can download
<code>Python</code> from the official website: <a href="https://www.python.org/downloads/">python.org/downloads</a>.</p>
<p>The <code>iRfcb</code> package can be configured to automatically
activate an installed Python virtual environment (venv) upon loading by
setting an environment variable. For more details, please refer to the
package <a href="https://europeanifcbgroup.github.io/iRfcb/">README</a>.</p>
<p>Load the <code>iRfcb</code> library:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(iRfcb)</span></code></pre></div>
</div>
<div id="download-sample-data" class="section level3">
<h3>Download Sample Data</h3>
<p>To get started, download sample data from the <a href="https://doi.org/10.17044/scilifelab.25883455.v3">SMHI IFCB
Plankton Image Reference Library</a> (Torstensson et al. 2024) with the
following function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Define data directory</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>data_dir <span class="ot">&lt;-</span> <span class="st">&quot;data&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># Download and extract test data in the data folder</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">ifcb_download_test_data</span>(</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">dest_dir =</span> data_dir,</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="at">max_retries =</span> <span class="dv">10</span>,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="at">sleep_time =</span> <span class="dv">30</span>,</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="particle-size-distribution" class="section level2">
<h2>Particle Size Distribution</h2>
<p>IFCB data can be quality controlled by analyzing the particle size
distribution (PSD) (Hayashi et al. 2025). <code>iRfcb</code> uses the
code available at <a href="https://github.com/kudelalab/PSD">https://github.com/kudelalab/PSD</a>,
which is efficient in detecting samples with bubbles, beads, incomplete
runs etc. Before running the PSD quality check, ensure the necessary
Python environment is set up and activated:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Define path to virtual environment</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>env_path <span class="ot">&lt;-</span> <span class="st">&quot;~/.virtualenvs/iRfcb&quot;</span> <span class="co"># Or your preferred venv path</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># Install python virtual environment</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">ifcb_py_install</span>(<span class="at">envname =</span> env_path)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co"># Run PSD quality control</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>psd <span class="ot">&lt;-</span> <span class="fu">ifcb_psd</span>(</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="at">feature_folder =</span> <span class="st">&quot;data/features/2023&quot;</span>,</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="at">hdr_folder =</span> <span class="st">&quot;data/data/2023&quot;</span>,</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="at">save_data =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  <span class="at">output_file =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>  <span class="at">plot_folder =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>  <span class="at">use_marker =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="at">start_fit =</span> <span class="dv">10</span>,</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  <span class="at">r_sqr =</span> <span class="fl">0.5</span>,</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>  <span class="at">beads =</span> <span class="dv">10</span> <span class="sc">**</span> <span class="dv">12</span>,</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>  <span class="at">bubbles =</span> <span class="dv">150</span>,</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>  <span class="at">incomplete =</span> <span class="fu">c</span>(<span class="dv">1500</span>, <span class="dv">3</span>),</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>  <span class="at">missing_cells =</span> <span class="fl">0.7</span>,</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>  <span class="at">biomass =</span> <span class="dv">1000</span>,</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>  <span class="at">bloom =</span> <span class="dv">5</span>,</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>  <span class="at">humidity =</span> <span class="dv">70</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>)</span></code></pre></div>
<p>The results can be printed and visualized through plots:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Print output from PSD</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">head</span>(psd<span class="sc">$</span>fits)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 8
##   sample            a     k `R^2` max_ESD_diff capture_percent bead_run humidity
##   &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;int&gt;           &lt;dbl&gt; &lt;lgl&gt;       &lt;dbl&gt;
## 1 D20230314T… 5.90e 5 -1.88 0.713            3           0.955 FALSE        16.0
## 2 D20230314T… 2.51e 5 -1.60 0.702            3           0.944 FALSE        16.0
## 3 D20230810T… 3.36e 7 -2.73 0.955            4           0.919 FALSE        65.4
## 4 D20230915T… 1.32e10 -5.54 0.989            2           0.967 FALSE        71.5
## 5 D20230915T… 4.39e10 -6.03 0.981            3           0.961 FALSE        71.5</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">head</span>(psd<span class="sc">$</span>flags)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   sample                   flag         
##   &lt;chr&gt;                    &lt;chr&gt;        
## 1 D20230915T091133_IFCB134 High Humidity
## 2 D20230915T093804_IFCB134 High Humidity</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Plot PSD of the first sample</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ifcb_psd_plot</span>(</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="at">sample_name =</span> psd<span class="sc">$</span>data<span class="sc">$</span>sample[<span class="dv">1</span>],</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="at">data =</span> psd<span class="sc">$</span>data,</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="at">fits =</span> psd<span class="sc">$</span>fits,</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  <span class="at">start_fit =</span> <span class="dv">10</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co"># Print the plot</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="fu">print</span>(plot)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABMlBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6kJA6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmOjpmZjpmZmZmkJBmkLZmkNtmtpBmtrZmtttmtv9uTU1uTW5uTY5ubqtuq8huq+SOTU2OTW6OTY6ObquOyP+QOgCQZgCQZjqQZmaQZraQkLaQtpCQtraQttuQtv+Q2/+rbk2rbm6rbo6rjk2ryKur5P+2ZgC2Zjq2kDq2kGa2tma2tpC2ttu22/+2/7a2/9u2///Ijk3I///bkDrbkGbbtmbbtpDb25Db27bb29vb2//b/7bb///kq27k////tmb/yI7/25D/27b/5Kv//7b//8j//9v//+T///9LnbbGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANSUlEQVR4nO2dCXvbuBGGoSixlOx2s62cpsqmd+O0201bu1eazW7bML3SJmG9vZzQimUF//8vFIMbFKghLcuEhPkePyYFgUPgFTAEcZCMk1aK9Z2A1EWAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIESbBrT48weMXf/+Sau4R3vxeCWT+toL+ekrYfGG3H133wS6sGOx9/FJ+K0LEypGxux8OoJ/TOvaS/8Ys7dhQIsjdfKGnNcjrwbE2IH4UMm9wVOTN8iXCyttXt23LkzasoAKVgfkjrF7GwZUsT3xK7w7klnD1AxIZm7xz7FAsDgaPOGLP0HeSvaNE7E38cLmU3G+xXM4nf3WC4ONBVTaXXtie4zb2zCgEn5VXZhlSR/8gPPZeHI8FjvVGAr+fDoROzeemnTaUl5ZqqX+9SuRYHGwzpKKDv9dmIoPn923Lkyca/DD6cgE/GhaA+SOcXsbL0ETu1+aajIb3x4LVI/FP/mjwycmC4dI1WxsassyIJfdxdFIU+eF/lKGqZ1CHF77Vobx+W9OdDh8P68Dcse4vU076edscPt3/1WpuPYCfrcRMHjAj5ksDnsixWx0IuuH+ukGD4TPHY98IwaQg1FKzhK+LqQqTJ6HDT7n4bc6DGSoFHsnS4DcMW5v45f5f/8KSssDuf+fv/56zEYSEniGE5kyuSPz7mqLQ8KDTwbQMXiPGqBj7VHm9z6AAhh8q8Pk14pK5QpZz4Dg/F99G2qaqjwS0MQk1P2OIi2QzkpfUkyxkKoBEp4WMhSWkefelfLd1JE2ht5N/WrkJYH3D4jrksJu//Zv/5uuAci4TuXYhHeHjYRmwswBg6f+tyZMHQWnK4PTOB9kjnF7mwWkq48802wMLkL5oBCQyrWpYpEGgX8V4/P7usJ61ykbNhv7tM01zoSpJDUD6uEqVrCPhWdeHI9lOk/gGq5LvwdINTmsk34CDaeIDxLtINgWtnAVcOBzgGbDREl6AO5IZM9+64Vxr15Fqphv0extGJBpp8qLuGlU1wFdH6tGq0ynrmOT4DLvtaS1JwvavV5YZVsJXjvbhmGArr4lre7FBlCMZAvwxhNZ2Wo+CFqML0w6ZyLa9Qd8GZCyYpyUuXOCOzA/bBbcTan7MxeGAPKOMXv93817KU5RBAgRAUJEgBD1DyhxESBEBAgRAUJEgBARIESbBcQSVhqANmp9LREgRAQI0RYBkr05XofMJBqrYLoj2kXmVe0mpfK62eb3TL8adETprlqv33qLAFUu1apPMUaohC9GQeSKfffr0yBu8aHrr/U6GaF7UfeiFvbwLQJUunJQyQHDoLt1dlOO20wP1BelX2iKICaff/IX860oiQaQNCD+mW2XpHWIdzH51uWsCpU/3UWqs1C4UiDZQCagOqjcqyzJ/0DJiyxK0y8VkFIOck1mH/3rliZWjSyKrQFUyV7n5TGL+fRDO/Wi0kPOsjaVsjqoLFWqn/jAj8yLg5kGIuCLv3LkHI9DsTVVDH5/kyFfsod69pEdchCF58Dw0EXt2ksdMPEj+zZuPr71EpyXK2CurBj/brdLSWubhcsX8zflKPQgvqSP4cp3PL75VA9jQG7DEhRE9lQuza+xgBR0NR9h4YaTEgQ0u/UPXcNCHwTy8yyyVrpfuuaD6pG1Cn/WjweWO79m/VuQtLZZ2JACQIuj70VqmC4cynnI9As61aDmS8xVzI8c2Ph7HdoWAvJnv3mSjrsyY78wMH2ghxD98flCtYP8yE6AL2wc1KqYnQOQqJPWm+i4u2o9y6kwE7Uvp8od1eYvgIcducihCnl4SF8CsjbhkPDQJAHFalhfShFQGb/L6kfpAYLpdhs9WTelBygxESBEBAgRAUJEgBARIEQECBEBQrSrgMxc2Ynajd3cuX4xPbkTIqkeADhk0i1N2wdIZhDue8u9k1gHnBn/MFI38GqQoxiZ2fS7DkgNAcRGiOz4h1al50wPnrrupi5p2mZApqAEHZRB36OJ4w1yZAIIJpnPp7HegaD3mtteN6//7KBTmrYPkHW8BYstFjbjH/qjWeOsAYnD9SG7C2hi13VFFZYgu+OqmPZPOw3IW8YBWuGDrLd2gPR3uw2oPirvKbyK2fEjCcgvXTsOaDZunJ5f+O0g+5gF3YfvxkR2HBAvG6YRcTP+ISO6hpKqYt4UoV0FdGkiQIgIECIChIgAISJAiAgQIgKEiAAhugpAZw/3v/ma8/NH+3ff1jeB9UwBnT865G/uvn3/hdh8i4eb0HqmgM4+fcvPf/bs/Oev+dlPXoeb0HregKKb0HqmgGQVu/Ps9K5EEm5C65kCAif90y+pBK2UcDnkg5oEBUVetz5b3oTWMwXET/cjDSBqB10gFQQIsU6AEOsECLFOgBDrBAixToAQ6wQIsU6AEOsECLFOgBDrBAixToAQ61kAcm8wUQ+L6GI9E0DetMD6InXEOgFCrA/bnuQKtREf9O7FxVKRDaDZ5xdLBQFCrGcDiKpYK7X10JwAtbVOgBDrBAixToAQ6wQIsZ4FIO9mlQBddiqyAGTfpXaBVGQBSK187PgUsrwAgcr60/taWc8IEOf+81DbWs8L0AVSkQ0gWAJaf+JlG+ssQUIbAaSfKNKeUGaAdLd095Y0AUKs5wJIvRA2/tCVldazAaSeedWhsZgdoFDvv9i/86zVPOkcAEUGDl8d8tN268XyBATLMrjaYGs18gBUn7xw9ukfoIq1We2TA6BlnT08BDpt1otlCqj9isM8AZ3/ovWa1TwBwVVMFJg268UyBSSaPC3XzWcKqLX1bAB5L23qZD0PQKIhpMmUrfulcwI0/+RlwwfcehaA1kkFAUKs5wKosg9A75iKPADp8bBOQ9BZATLPjY2/SXel9SwAuVeklu2LUE6AvKeg06hGTOsASnHsmQAhIkCIkpqjmKITSqolTYAw6zkAWuduPgtA4IS0m+7cH5QHIK5eFnORHsVsAF04FQQIsS4BbfZUXbWRdlDnufY5AVorFQQIsZ4DoPVvNRj8JUNpcyWouOhlPg9A8+kFFrNkBKjqdiWzgKDDIwdABeuwUINnB2hx1GlQjOcGaDZuf/mqWc8CUNmxevnWFSCBh+0uoPXaQRkAWisVBAixzmBggwA1W9eAgNBGz9dBBAgRAUJEgBBdBaDT/ZYTyR2gXW4oLgmWZCytpIsuqMsUEGhpFUt0MYsPKBVCVwRIFJYWy6GyBXT28M4z3mJBndwOMwTEWy6o04B4hoD4q8OWPsgBSgPRFQDStanFgjrlhOSHnADxN/stHyyQK6AO1gkQYp0AIdall5Y7BChqnQAh1pnqdSVATdY9QIk0FRMEpAboCVDUugWUTB0jQIgIECIChChFQFx5aQIUs84I0GrrBAixToAQ6wQIsa64mHlmCYgAIUobUAL3Y8kBUlCGBKjBegAohTv6RAHJnmkCFLFOgBDr1u8ME2kKESBEyQJiQwIUs+4AwTwYe53vD1TigDgBqllnHpIhAVq27gNi0lGzzZ9+lZIGxPSExT5vOZIGZKabEaBGQOqmjAA1A2JD3b3Yl1ID5AfZFiMBWgmID4cEKBqkATFA1NuVPllA3AMEw9HDnh5OtQWA9E0rMOoB0hYBgg/D4VVj6g1QfCJ55JxML4P2mtRDo8tOVGMiLi9eW8UX1DWcuw7Ixh8GuuQktkla93htFV/M0nhuptjoZmTDVX+Iq3tC+wIUXw7VeG7GdSFi66kFwxrLvgDFF9QlqG0oQb1qG3xQr+rvKhZdUJeeUm4HJaGUW9JJiAAhIkCICBCiRAAlrCQA7YAIECIChIgAISJAiAgQIgKEqE9Ab/blY/SC29u6ZNdJ7MEyS5FWWzt7uL9/iFtaVp+AXh3C/7Cbv6ZTyHP0AXv1SKutQR/e2Y+fYZYi6hHQ+y9lx2PYxRbq1Z0/im+iD7eqR1pt7RRw1J+W1SqVPQIS5RyKfdhJWxfkI/p4tHok3FrTg9ZWq0dAosjD7x528y9FEnmPPmCvHgm1Bn2dqKVl9X0Ve3V4SSUIs3b+6DOOW1pW/4BWO4Qz3AcFgJoinT0EH75dPggK+vvfvw67+euCfEQfsFePtNqa4oNbWlbP7SDvKXpxdWoHNVuDRhL48O1qB22FCBAiAoSIACEiQIgIECIChCgdQIsjNV4Fr1YqxRZeFajDRl6k+BvO5vc6vFiwk1ICZF8uWQKkih3osMWRfW9g2fQKr6rzS3JbKkVAupgUeyc6bD7V5aa5oDQVrbWVJqD6nik4pSgns5uy7k1mNx+PGZvMxD9gs6kilCIgUbv0u1xNmM69/GgBjUVgCW/tlDVSBm9AKQFSTloiKZVrtoDUS/FkVXOA4MPYhNhqeMlKCVD4BuD51PogU4JCQLB1/+qHX5bSBQT5NmGF8kEESEm7EwfIVB8FCGrVfFoHlFUVK1QjcbTUDirASSvnXAeUj5MGOKX21jrMXd7kZf47jN24XwdU7vxlvo2goRgvKhk0FFtJtBjjgDK41WglUVCigHK4WU1UBAgRAUJEgBARIEQECBEBQkSAEBEgRAQI0f8Btf8owLdHfWgAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="geographical-qcqa" class="section level2">
<h2>Geographical QC/QA</h2>
<div id="check-if-ifcb-is-near-land" class="section level3">
<h3>Check If IFCB Is Near Land</h3>
<p>To determine if the IFCB is near land (i.e. ship in harbor), examine
the position data in the <code>.hdr</code> files (or from vectors of
latitudes and longitudes):</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Read HDR data and extract GPS position (when available)</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>gps_data <span class="ot">&lt;-</span> <span class="fu">ifcb_read_hdr_data</span>(</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="st">&quot;data/data/&quot;</span>, </span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="at">gps_only =</span> <span class="cn">TRUE</span>, </span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span> <span class="co"># Do not print progress bar</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co"># Create new column with the results</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>gps_data<span class="sc">$</span>near_land <span class="ot">&lt;-</span> <span class="fu">ifcb_is_near_land</span>(</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  gps_data<span class="sc">$</span>gpsLatitude,</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  gps_data<span class="sc">$</span>gpsLongitude,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>  <span class="at">distance =</span> <span class="dv">100</span>, <span class="co"># 100 meters from shore</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>  <span class="at">shape =</span> <span class="cn">NULL</span> <span class="co"># Using the default NE 1:10m Land Polygon</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>) </span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co"># Print output</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="fu">head</span>(gps_data)</span></code></pre></div>
<pre><code>##                     sample gpsLatitude gpsLongitude           timestamp
## 1 D20220522T000439_IFCB134          NA           NA 2022-05-22 00:04:39
## 2 D20220522T003051_IFCB134          NA           NA 2022-05-22 00:30:51
## 3 D20220712T210855_IFCB134          NA           NA 2022-07-12 21:08:55
## 4 D20220712T222710_IFCB134          NA           NA 2022-07-12 22:27:10
## 5 D20230314T001205_IFCB134    56.66883     12.11303 2023-03-14 00:12:05
## 6 D20230314T003836_IFCB134    56.66884     12.11302 2023-03-14 00:38:36
##         date year month day     time ifcb_number near_land
## 1 2022-05-22 2022     5  22 00:04:39     IFCB134        NA
## 2 2022-05-22 2022     5  22 00:30:51     IFCB134        NA
## 3 2022-07-12 2022     7  12 21:08:55     IFCB134        NA
## 4 2022-07-12 2022     7  12 22:27:10     IFCB134        NA
## 5 2023-03-14 2023     3  14 00:12:05     IFCB134     FALSE
## 6 2023-03-14 2023     3  14 00:38:36     IFCB134     FALSE</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Alternatively, you can choose to plot the points on a map</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>near_land_plot <span class="ot">&lt;-</span> <span class="fu">ifcb_is_near_land</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  gps_data<span class="sc">$</span>gpsLatitude,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  gps_data<span class="sc">$</span>gpsLongitude,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="at">distance =</span> <span class="dv">2500</span>, <span class="co"># 2500 meters from shore</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co"># Print the plot</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="fu">print</span>(near_land_plot)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>For more accurate determination, a detailed coastline
<code>.shp</code> file may be required (e.g. the <a href="https://www.eea.europa.eu/data-and-maps/data/eea-coastline-for-analysis-2/gis-data/eea-coastline-polygon">EEA
Coastline Polygon</a>). Refer to the help pages of
<code>ifcb_is_near_land()</code> for further information.</p>
</div>
<div id="check-which-sub-basin-an-ifcb-sample-is-from" class="section level3">
<h3>Check Which Sub-Basin an IFCB Sample Is From</h3>
<p>To identify the specific sub-basin of the Baltic Sea (or using a
custom shape-file) from which an IFCB sample was collected, analyze the
position data:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Define example latitude and longitude vectors</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>latitudes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">55.337</span>, <span class="fl">54.729</span>, <span class="fl">56.311</span>, <span class="fl">57.975</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>longitudes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">12.674</span>, <span class="fl">14.643</span>, <span class="fl">12.237</span>, <span class="fl">10.637</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># Check in which Baltic sea basin the points are in</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>points_in_the_baltic <span class="ot">&lt;-</span> <span class="fu">ifcb_which_basin</span>(latitudes, longitudes, <span class="at">shape_file =</span> <span class="cn">NULL</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co"># Print output</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="fu">print</span>(points_in_the_baltic)</span></code></pre></div>
<pre><code>## [1] &quot;13 - Arkona Basin&quot;   &quot;12 - Bornholm Basin&quot; &quot;16 - Kattegat&quot;      
## [4] &quot;17 - Skagerrak&quot;</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Plot the points and the basins</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">ifcb_which_basin</span>(latitudes, longitudes, <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="at">shape_file =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAACAVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYAv8Q6AAA6ADo6AGY6OgA6OmY6OpA6ZmY6ZpA6ZrY6kJA6kLY6kNtNTU1NTVlNTV5NTW5NTYNNTY5NWV5NbqtNeXlNechNjshTTU1TTWRXbHNZTU1ZTY5dTU1eTW9eTYNkTU1kTY5kq+RmAABmADpmAGZmOgBmOjpmOmZmOpBmZgBmZmZmkJBmkLZmkNtmtttmtv9pTVlrWU1uTU1uTVluTWRuTW5uTW9uTYNuTY5ubo5ubqtug45ujqJujshunZ1uq8huq+RvZG5voqt5eU15yOR8rgCOTU2OTW6OTY6Obk2ObquOjm6Ooo6OtauOyKuOyOSOyP+QOgCQOjqQOmaQZgCQZjqQZmaQkGaQkLaQtpCQtraQttuQ27aQ29uQ2/+ig02ijk2raV6rbk2rbm6rbo6rjk2rjm6ryKurzaur5OSr5P+1q262ZgC2Zjq2kDq2kGa2tpC2ttu225C229u22/+2/9u2///HfP/Ig03Ijk3IyI7I5KvI/8jI/+TI///M4ejW6/LbkDrbkGbbtmbbtpDb27bb29vb2//b/7bb/9vb///kjmTkq27kq3nkq4Pkq47k5Kvk///r6+v4dm3/tW7/tmb/yI7/zX//25D/27b/29v/5I7/5Kv//7b//8j//9v//+T///+gn9KVAAAACXBIWXMAAA7DAAAOwwHHb6hkAAASgUlEQVR4nO2di39cRRXHJ6W1SQsFNNGKaBXflhbxxWoViSCIj/LwRVJBRDAqqFQIiAqtBU02FlRiFJq4ZdG02/tXes9jnvfePXt3N003e36fT7t3587cxzczZ+aeM3PXZKquMtt9AVe6FJAgBSRIAQlSQIIUkCAFJEgBCVJAghSQIAUkSAEJUkCCFJAgBSRIAQlSQIIUkCAFJEgBCVJAghSQIAUkSAEJUkCCFJAgBSRIAQlSQIIUkCAFJEgBCVJAghSQIAUkSAEJUkCCFJAgBSRIAQlSQIIUkCAFJEgBCVJAghSQIAUkSAEJUkCCFJAgBSRIAQlSQIIUkCAFJEgBCVJAghSQIAUkSAEJUkCCFJAgBSRIAQlSQIIUkCAFJEgBCVJAghSQoBqAVgxq9+NhYmd+z2rwtf3pU0mpJEN4pOteLGSE8mUlOr+72pirPl9I764Lh/d2/S5eaNYPIGMa1Ydd2VUDkIkyY0YoX1KiM08FSm+hWpcbEN3P2W6XWQRUnavzXBF1RfmW2ZPXtrfnowKyagGqUH1A2SJ8vn00b2wv0m3l/1642kx8gf7Q01nnEWMmbuNSUYb4SO2p6fz/s3njgV15ptexPP0pz06Z3QuuwMSCv0E49TXYOm1RPhOflsp35vdC/tYUXqYD5L67smGx4EJtcp+A8vPkyi+bDstNr8M3GDbEKEN0pM7zcNsrdlcMqMXHJ7XMtLuMtj21L8on8gdygK6aCg8TfA9OGxTzF+qS+2lie6H4bXASZA6H3Zu3jjwd87Snrs+t7dTeCJDNQEdiGzQNu3e9mGHuyAZ15vO7OOuxPGcmrv3p3+l48Hd9FQvYogyOTxsCMu9a7Tzvzuu/+7JRMX+hLrkPI51fOl/V4sQCHRbQYf0nQFd97o+uVJIhOtL1aMz+9sKPp0wCiFpfoNcemaIqz3vor8VFGRCfNgREW9awRd+5bFTMX6hLrg/oGkSP9bplAdkrouteDPvwJEPm7w7rIreYIqCiOe68ektepVrhn4mLkuxpQ0AEc2IBr33afw/KhsWCC7XJfdigTAKUvXrU9+FdAIE1y2v9tT/5/T8O9wCIjuUB+aIsPm0vgMKyQbHwQjm5X0BxE0sA5XrtYTaeAiAiUbBBcROjphEW8H8lZ4P8aRdtO6FGHTYx+z0pC8VKLhSS+wOUGmkPKK+9rdwSchfVHRCMqPJrXIWOmzOtuI4RmoHlktd3aLGds1O453EYEsFN2qKYx5920eCIA410PuiIjDR/92VdsfhCXXJ/gNJu3gPy3TxfdykgPyb3Y2QCFHXzblyQ35k1PNYITafDa39azLH7KAC6dsoEA3b/PTxtcH5/oS65T0BZOx4o2vu/cDTvJ3GMdT3/8bsAugbqGI44H19k0wHlX7cDRTfY5GexCTL8cOqrbguLch532r9OmeteJxuU/yUPBANF992XtcWSC7XJ+jQvSAEJUkCCFJAgBSRIAQlSQIIUkCAFJOiKALQSuv0StfeV76hKH7auBED4DNOqcMhfLhBVqg1oPS9jTDP/t26MT+tpq1ydeUSzWB4suWIArc3MzNywlG0eg/9Rm8fm4P/ZpagAA2ri46ZP62mrXJ35ab9Jz97o76PU9r5H6YHdpuFnA8C19z02ZWpGgmrLAToDNLKL981lazeeu/SbmbtzQIAqAIRI1olPkx0WuGMwQOCeIBjkMdmzeuFwI4gNwUM2PJlTGtao9lQDAE1VR9KGJgvo0lPPwMfmneeyi/c/c/6h7I25zdmXD8U1CIAQFyTUNNlQAJGVztm0yBXY+C80Nm5b6PvLt21aez8BQUCNrW+CFtDF+/ImNpcAWsqrlQO0ngvhLLPADK2b9TrqciHgVl2xvjD0eVG/hkCw+nDaIrnpsYktXD5Am7c/A7UIm9jBZ6iJzS5d/O65uIk1sfKQhmWDWPmdrrCdvnAYHK77IkBB2oXDBpvaZQWEggpzbOYb1Nqw7qzd6wBxy1oeOiBLYt9CiwdDLQDFXyyFMA2AbRegXBcfICSA5tJTTweAmhGgZUdowBq0CLdNjmDwKE8gqPYUA2IjbdPQThGdywro/I3nsku/WsrtT7Z2iJKw7lBXRlmbBUC8Z9AmtsKWB7t54JLbmYknDmMHjt08GB2bxqbostegfBx0MG9a52dmclQoalxrFhAbnwBQc0g16IpW7yPppgLqLgUkSAEJKgEEhOAACghUXoOwq1dAoFJARgE5lTcxlAIClQFir5ACAlUDGo8aJHoUQ0CnT5+2gOAYYwGIH1ThWazcoxgAOg0iVGNTg0KP4gNLZR5FD+g0yQEaCxvEHkWuQWUexWUnC4jdijWcitt2m/0r8SgCKHB8lHgUx7wGoc7MAafzN3iHWeBRLLdBzTEDBH4zaGagxKNY7MXMsEfSGxsbZcnolm4nITCaKl8WFLNxj7JvlQUL2awSj2JagwKPYjwOctGf5vBq0MZGKaEWxBIv3LwQOw+JWpk7UQJUWbBUJR7Fg1SBUo9iCAjhDLuJbWyUElqceCy/pRZ6XYO/O95n58QCxTiy9jVHd/3hwMMYc93/GawhvGP/qc6JR42ZtuFJV5DrZMtwtjYVrwIkKnoC83VpeOOgCkC+EkAtihPbB1azxWmIgkAQEdYvtGgZA8RAeEcOaH4vrXzC49iCWCf3n7pw5FS2gvtsuVi1AWF0NXrouFyAghh+Zk3JnlW4wfxeIQ//4w+/A6oL1jUEbAvCQfI8TN2XS05eFxDCSOIbwxpJV/Dhq+alOi6yii1lvgGf+d0XAfkdCSAuiEfC5W0YJBkqoCyOkBl/kK3sxRrFxNwq1a9BtuDhhuVBLXEogKxBNnENckfZknEQXnm6gIxC0vktO1OTAApsUBGQRUoR2+EBsmOetAZtPSCa1xD2YnY44zqrFFDQixVtUAPDlbuPNmxD2wJAxk5k2GpA26pagHwEw2DDsjM9lpu9BaFHUXUAmRiQnwnTa5R+FJV4FOF/cHuAUo9iMJssnecxDjWIPIqg8+UexSCKWpjn0WOMdRSVeBQz8rpWzFEErQ8wz2MUlXgUc8H0oKo5ius0UXG5RD35FbfpJgdR6lEkb1D5HEVUeQ1qhhaqcmsUVZiCd97On0o9iqwqQERoDACdudd+SzyKrEpAwSgpq9gaRSUexcBYF+YoksYVkPUoWod0VvAostbdANH6Fr3rbEcD6lV2rYbD4uuSkYLQo6j+lkOVNrGm6HwdRfUFqNwGua7M5itsSTp+/HhZMvogWslbBQMXNbgyqlUzzJOqH0C84qcE0GA16PjxUkIt6+9Z2Runf5Z91AKgemGeVH0B4qIe0OTk5OBN7PjxUkIU9gHFf/XOiSduXcVwz0sn8OU/7CDj4I0LNNYM86TqH1BQgyZBA3fzFYA8mLgGtQ+sLjbQFds58TMIeCyGQR8O6mS1wzyphgFoctIR2kJAdnWL1co0RBMpdnH1NIZwQu99Rim1wzyp+rRB0MAKgJpSjFVQBZ8kcMhhH3xF1C4K7sy/ExpbHP9hX3PtME+qPlc9+9CzB9Q9CG16OFm3XgwUhZ4PrEICY8mrU1yDfFCnZpgnVTpH8dKTPjZfserZzltIbFD5w6oJ1O8ifbgLMBZR6HkFYLX2MiAwwlH8h4M6We0wTyUg9ijmHxUeRQ8omrxgezFTbqQJJhNq9g8IgjShDer8CKOtNz9GgKjShPEfDurUDvNUAeKHVF5tKHkU7bpwCwjbT4mR9jWNIPUHaFtVWPX8a2hiXT2K62Z52fAExdCbWJytSONJ53NcXt622+xfiUcR7M7mnecEj6Jb3uusS0aRoKQGpc9sfTaxbVU6R/HOeApe0aNIdLDpmGbTvmkgKwNUeGbbAYDyKlM1R5HzOz4Qy2jSZCEHyOxcQNajeIbevgAq9yhCn9R0K+ipAq27NhYC8oHpnQDIeRTv82s1ih5F4wyQtT9ZFhmh0N2xwwD1lDno2v2cDg/IUIePWs/MjmpivWaHR1TT5IGQTVzHioStz+XcaTaox9xuUGySKQumbN3PjuvmpbwOAQEKJr0AivxRc8wBZfZ53T7NR4DQWeEOZ8ayiRk/iTMzSRML3F32+XQ8ezHbiEwyr4wBuX6OjPk4AzLxvDIG5FjgMBL/jSsgerEAbqMTDfmkMz6o8+8V0OTkZFkyO03jl3WSH8z9qAb7dyqL963Uo8gfoKJH0QSDZRM8yhMDqD/FaGsYHhIAoWOymIxxMXC3RiEIckY3gq9bDMh7FDM7garwHkVbKfCLIb8ZrhcrMcgekN/bHRC7ttNkiotRhCIQTBCftx7DBv2uxC72KsIc8t23LLhdg7xqMfEo8ke5R9GOftjHYScvmHTGRwTIBE9lfQHipQgHHk6b2EvIh8NdXIMWpzF6Bu7piQW/q38+hVXP9FHqUeSAMw0XvavQ+eTLZi7ehPnd1wEAwXqwA2ET23e1/8WVIwwIkEDs68gpG4+mXUMAZD2K9FHlUTTcsGigaCKPfPISwWByjDdC3a+lgg/XoNU4Ltaesr9ltMjxMfLbg28fMiMgu2sIgFCRHSp6FC0GotKk8GFApwjopo2NjRrdfJde7MKtq8UVhxDX4XAXAzriQqo5IL+rDzDupsMvRUChR9HCsAEN8iOayMokgHCJ3MDjIAqUpk0MY0EcB8NXvPolUGyD/K7+zkt3zZ/sUbSORVDhPYrGesvI38FeoAwsUrMUEC+yHAqgtDPiwRG+AHb30UZnftdL89iLgSnPP96RNzG3awi9mPUorlWueqbsbglUMCKqAmSGBKgvDVZvvGrH8oJZQU3ncY3qjVsTvW2A7As9h6GBANFLpWNA0cPqcGzQtmpAQNTcgrTA3wjNsF4vdiVqAEC+5kRL6wzFysbS3eGHQjGgZfcrAMY9v1t3x5gBQtdG5t/67+qItdccjB5nQMbOdTFR506A1u2T7DgDonLwDB8AsisOQyM9poD8VgAoiG8YGmcXABljap/sClDqUcyyS0/y8t7KX2axW0EUOtxLsz9iQKMJB1Rc9bw2M1fhUUSlM+3JOxTs5TYWAhpZOlnBo5gD+dqDc8IcRSpoll3lWc9MuJee8h2gUcZT8CjmoH77ZIVHMZl/uMzuxaoVzoYmMUYZtu02+1e66nntXrBB3ecoUkGz7ia+lE4fN9b09I7l9OnTZcmlb3/B33/edUpY6hOq95yhinMUvZGuWvXst7oBsjt7B4SvZywmt6wjKAr70K9F7Vm9zIDo3R208Lly1XPfW93FL/hMk91yqMjj6ibQd2gtFK914nhP8Ga8/N8p2sk5e7waq3SOYtjNV6167nuruyoAOd9XvBrK3iuthbKrn8jXytEfejNew+7kVVM1lXoUU0DFVc8DbHWXACiuQBmujIMfvMe1UCAf7+HoT7jWIP/qc9bRICPp2luCKvjwTVoLxGEf2rNvgdZC2QgPxXts9McBwp02Zz1dSYC69WIYLQ2Fr+bMFhu8FooiPLYGUfTHv8yswa8yWxmgifWqrQRUIbfqNBT2YmykT9gIT2CD4jfjYV2jVVM1NTKACiYI2tHEgl0LxWudON5D0R/XxDj8c2Khj1jHKACqp2HFe1gj/ZxU0DDjPaydBWgLpIAEKSBBCkiQAhKkgAQpIEE9AsIne/zVFnrG3zwGfqP88Z82cCn5jN3ye9dK0kZMvQE6T2+tmMvW3j/z3u/N3J39Z+aGl2Hr6/efnH3ly7B11+wrs8/y3s0vznwft878AHBaB+4W38rWqCdAZw6CXxHeyvCnd//wK9/J3vj2ez720YNP51v//MDm7C9mvgVpc5uzP6e9c2996Eu499/fPAlYbAhgq+9lS1SjidGa+pME46ufXNpkLH+2abPPHsK0h3758QfnYOtfn4hmXW/tnWyRagCi3/05eQc2IrQo74u23vogb63dw2l33X4yyefegzoyql+DyEhDDcKt/334U2xfsC5hvjfveHDOpi0Fk4pHUTUAgQ3azE1xBGjz2EeWMg8DjDJ1XfeMH6BLT96brR3ajABtHgMk1ADf5BqU7+UaBGl/CWddj6AGGgfNcBwNTfGa23J7S9NGTDqSFqSABCkgQQpIkAISpIAEKSBBCkiQAhKkgAQpIEEKSJACEqSABCkgQQpIkAISpIAEKSBBCkiQAhKkgAQpIEEKSJACEqSABCkgQQpIkAISpIAEKSBBCkiQAhKkgAQpIEEKSJACEqSABCkgQQpIkAISpIAEKSBBCkiQAhKkgAQpIEEKSJACEqSABCkgQQpIkAISpIAEKSBBCkiQAhKkgAQpIEEKSJACEqSABCkgQQpIkAISpIAEKSBBCkiQAhKkgAQpIEH/Byqh8AAveBUQAAAAAElFTkSuQmCC" /><!-- --></p>
<p>This function reads a pre-packaged shapefile of the Baltic Sea,
Kattegat, and Skagerrak basins from the <code>iRfcb</code> package by
default, or a user-supplied shapefile if provided. The shapefiles
provided in <code>iRfcb</code> originate from <a href="https://shark.smhi.se/hamta-data/">SHARK</a>.</p>
</div>
<div id="check-if-positions-are-within-the-baltic-sea-or-elsewhere" class="section level3">
<h3>Check If Positions Are Within the Baltic Sea or Elsewhere</h3>
<p>This check is useful if only you want to apply a classifier
specifically to phytoplankton from the Baltic Sea.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Define example latitude and longitude vectors</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>latitudes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">55.337</span>, <span class="fl">54.729</span>, <span class="fl">56.311</span>, <span class="fl">57.975</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>longitudes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">12.674</span>, <span class="fl">14.643</span>, <span class="fl">12.237</span>, <span class="fl">10.637</span>)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co"># Check if the points are in the Baltic Sea Basin</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>points_in_the_baltic <span class="ot">&lt;-</span> <span class="fu">ifcb_is_in_basin</span>(latitudes, longitudes)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="fu">print</span>(points_in_the_baltic)</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Plot the points and the basin</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">ifcb_is_in_basin</span>(latitudes, longitudes, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>This function reads a land-buffered shapefile of the Baltic Sea Basin
from the <code>iRfcb</code> package by default, or a user-supplied
shapefile if provided.</p>
</div>
<div id="find-missing-positions-from-rv-svea-ferrybox" class="section level3">
<h3>Find Missing Positions from RV Svea Ferrybox</h3>
<p>This function is used by SMHI to collect and match stored ferrybox
positions when they are not available in the <code>.hdr</code> files. An
example ferrybox data file is provided in <code>iRfcb</code> with data
matching sample <strong>D20220522T000439_IFCB134</strong>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Print available coordinates from .hdr files</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">head</span>(gps_data, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##                     sample gpsLatitude gpsLongitude           timestamp
## 1 D20220522T000439_IFCB134          NA           NA 2022-05-22 00:04:39
## 2 D20220522T003051_IFCB134          NA           NA 2022-05-22 00:30:51
## 3 D20220712T210855_IFCB134          NA           NA 2022-07-12 21:08:55
## 4 D20220712T222710_IFCB134          NA           NA 2022-07-12 22:27:10
##         date year month day     time ifcb_number near_land
## 1 2022-05-22 2022     5  22 00:04:39     IFCB134        NA
## 2 2022-05-22 2022     5  22 00:30:51     IFCB134        NA
## 3 2022-07-12 2022     7  12 21:08:55     IFCB134        NA
## 4 2022-07-12 2022     7  12 22:27:10     IFCB134        NA</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Define path where ferrybox data are located</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>ferrybox_folder <span class="ot">&lt;-</span> <span class="st">&quot;data/ferrybox_data&quot;</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co"># Get GPS position from ferrybox data</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>positions <span class="ot">&lt;-</span> <span class="fu">ifcb_get_ferrybox_data</span>(gps_data<span class="sc">$</span>timestamp, </span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>                                    ferrybox_folder)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co"># Print result</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="fu">head</span>(positions)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   timestamp           gpsLatitude gpsLongitude
##   &lt;dttm&gt;                    &lt;dbl&gt;        &lt;dbl&gt;
## 1 2022-05-22 00:04:39        55.0         13.6
## 2 2022-05-22 00:30:51        NA           NA  
## 3 2022-07-12 21:08:55        NA           NA  
## 4 2022-07-12 22:27:10        NA           NA  
## 5 2023-03-14 00:12:05        NA           NA  
## 6 2023-03-14 00:38:36        NA           NA</code></pre>
</div>
<div id="find-contextual-ferrybox-data-from-rv-svea" class="section level3">
<h3>Find Contextual Ferrybox Data from RV Svea</h3>
<p>The <code>ifcb_get_ferrybox_data()</code> function can also be used
to extract additional ferrybox parameters, such as temperature
(parameter number <strong>8180</strong>) and salinity (parameter number
<strong>8181</strong>).</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Get salinity and temperature from ferrybox data</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>ferrybox_data <span class="ot">&lt;-</span> <span class="fu">ifcb_get_ferrybox_data</span>(gps_data<span class="sc">$</span>timestamp,</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>                                        ferrybox_folder,</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>                                        <span class="at">parameters =</span> <span class="fu">c</span>(<span class="st">&quot;8180&quot;</span>, <span class="st">&quot;8181&quot;</span>))</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co"># Print result</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="fu">head</span>(ferrybox_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   timestamp           `8180` `8181`
##   &lt;dttm&gt;               &lt;dbl&gt;  &lt;dbl&gt;
## 1 2022-05-22 00:04:39   11.4   7.86
## 2 2022-05-22 00:30:51   NA    NA   
## 3 2022-07-12 21:08:55   NA    NA   
## 4 2022-07-12 22:27:10   NA    NA   
## 5 2023-03-14 00:12:05   NA    NA   
## 6 2023-03-14 00:38:36   NA    NA</code></pre>
<p>This concludes this tutorial for the <code>iRfcb</code> package. For
additional guides—such as data sharing and MATLAB integration—please
refer to the other tutorials available on the project’s <a href="https://europeanifcbgroup.github.io/iRfcb/">webpage</a>. See how
data pipelines can be constructed using <code>iRfcb</code> in the
following <a href="https://github.com/nodc-sweden/ifcb-data-pipeline">Example
Project</a>. Happy analyzing!</p>
</div>
</div>
<div id="citation" class="section level2">
<h2>Citation</h2>
<pre><code>## To cite package &#39;iRfcb&#39; in publications use:
## 
##   Anders Torstensson (2025). iRfcb: Tools for Managing Imaging
##   FlowCytobot (IFCB) Data. R package version 0.6.0.
##   https://CRAN.R-project.org/package=iRfcb
## 
## A BibTeX entry for LaTeX users is
## 
##   @Manual{,
##     title = {iRfcb: Tools for Managing Imaging FlowCytobot (IFCB) Data},
##     author = {Anders Torstensson},
##     year = {2025},
##     note = {R package version 0.6.0},
##     url = {https://CRAN.R-project.org/package=iRfcb},
##   }</code></pre>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ul>
<li>Hayashi, K., Enslein, J., Lie, A., Smith, J., Kudela, R.M., 2025.
Using particle size distribution (PSD) to automate imaging flow cytobot
(IFCB) data quality in coastal California, USA. International Society
for the Study of Harmful Algae. <a href="https://doi.org/10.15027/0002041270" class="uri">https://doi.org/10.15027/0002041270</a></li>
<li>Torstensson, A., Skjevik, A-T., Mohlin, M., Karlberg, M. and
Karlson, B. (2024). SMHI IFCB Plankton Image Reference Library.
SciLifeLab. Dataset. <a href="https://doi.org/10.17044/scilifelab.25883455.v3" class="uri">https://doi.org/10.17044/scilifelab.25883455.v3</a></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
